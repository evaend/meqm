<?xml version="1.0" encoding="UTF-8" ?>
<!DOCTYPE mapper PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN" "http://mybatis.org/dtd/mybatis-3-mapper.dtd" >
<mapper namespace="com.phxl.ysy.dao.GkTemplateMapper" >
  <resultMap id="BaseResultMap" type="com.phxl.ysy.entity.GkTemplate" >
    <id column="GK_TEMPLATE_GUID" property="gkTemplateGuid" jdbcType="VARCHAR" />
    <result column="GK_TEMPLATE_NAME" property="gkTemplateName" jdbcType="VARCHAR" />
    <result column="F_ORG_ID" property="fOrgId" jdbcType="DECIMAL" />
    <result column="R_ORG_ID" property="rOrgId" jdbcType="DECIMAL" />
    <result column="F_STORAGE_GUID" property="fStorageGuid" jdbcType="VARCHAR" />
    <result column="R_STORAGE_GUID" property="rStorageGuid" jdbcType="VARCHAR" />
    <result column="USER_ID" property="userId" jdbcType="VARCHAR" />
    <result column="CREATETIME" property="createtime" jdbcType="DATE" />
    <result column="LASTMODIFY" property="lastmodify" jdbcType="DATE" />
    <result column="TF_REMARK" property="tfRemark" jdbcType="VARCHAR" />
    <result column="FTYPE" property="ftype" jdbcType="VARCHAR" />
  </resultMap>
  <sql id="Base_Column_List" >
    GK_TEMPLATE_GUID, GK_TEMPLATE_NAME, F_ORG_ID, R_ORG_ID, F_STORAGE_GUID, R_STORAGE_GUID, 
    USER_ID, CREATETIME, LASTMODIFY, TF_REMARK, FTYPE
  </sql>
  <sql id="Base_Column_List_With_Prefix">
		tp.GK_TEMPLATE_GUID "gkTemplateGuid", tp.GK_TEMPLATE_NAME "gkTemplateName", 
		tp.R_STORAGE_GUID "rStorageGuid", 
		s.storage_name "rStorageName"
	</sql>
 <select id="searchGkTemplateList" parameterType="com.phxl.core.base.entity.Pager" resultType="Map">
	SELECT <include refid="Base_Column_List_With_Prefix"></include>
	FROM TB_GK_TEMPLATE tp
	LEFT JOIN td_storage_info s ON tp.R_STORAGE_GUID = s.STORAGE_GUID
	<trim prefix="where" prefixOverrides="and | or ">
 		<if test="conditiions != null">
	 		<if test="conditiions.orgId != null and conditiions.orgId != ''">
	 		  and tp.f_org_id = #{conditiions.orgId, jdbcType=DECIMAL} 
	 		</if>
	 		<if test="conditiions.rStorageGuid != null and conditiions.rStorageGuid != ''">
	 		  and tp.R_STORAGE_GUID = #{conditiions.rStorageGuid, jdbcType=VARCHAR} 
	 		</if>
	 		<if test="conditiions.searchName != null and conditiions.searchName != ''">
	 		  and regexp_like(tp.GK_TEMPLATE_NAME, #{conditiions.searchName,jdbcType=VARCHAR})
	 		</if>
  		</if>  		
  	</trim>	 
	ORDER BY tp.CREATETIME	desc  
  </select>
</mapper>